{"version":3,"sources":["../../models/meal.js"],"names":["p","path","join","__dirname","Meal","title","description","image","price","defaultQuantity","Object","assign","meals","JSON","parse","constructor","fetchMeals","meal","id","length","push","fs","writeFileSync","stringify","err","index","findIndex","m","message","readFileSync","filter"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;;;;;;;AAEA,IAAMA,CAAC,GAAGC,cAAKC,IAAL,CAAUC,SAAV,EAAqB,SAArB,EAAgC,YAAhC,CAAV;;IAEMC,I;;;AACF,sBAMG;AAAA,QALCC,KAKD,QALCA,KAKD;AAAA,QAJCC,WAID,QAJCA,WAID;AAAA,QAHCC,KAGD,QAHCA,KAGD;AAAA,QAFCC,KAED,QAFCA,KAED;AAAA,QADCC,eACD,QADCA,eACD;;AAAA;;AACCC,IAAAA,MAAM,CAACC,MAAP,CAAc,IAAd,EAAoB;AAChBN,MAAAA,KAAK,EAALA,KADgB;AACTC,MAAAA,WAAW,EAAXA,WADS;AACIC,MAAAA,KAAK,EAALA,KADJ;AACWC,MAAAA,KAAK,EAALA,KADX;AACkBC,MAAAA,eAAe,EAAfA;AADlB,KAApB;AAGH;;;;0BAMK;AACF,UAAI;AACA,YAAMG,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAW,KAAKC,WAAL,CAAiBC,UAAjB,EAAX,CAAd;;AACA,YAAMC,IAAI;AACNC,UAAAA,EAAE,EAAEN,KAAK,CAACO,MAAN,GAAe;AADb,WAEH,IAFG,CAAV;;AAIAP,QAAAA,KAAK,CAACQ,IAAN,CAAWH,IAAX;;AACAI,oBAAGC,aAAH,CAAiBtB,CAAjB,EAAoBa,IAAI,CAACU,SAAL,CAAeX,KAAf,CAApB;;AACA,eAAOK,IAAP;AACH,OATD,CASE,OAAOO,GAAP,EAAY;AACV,eAAOA,GAAP;AACH;AACJ;;;2BAEMN,E,EAAI;AACP,UAAI;AACA,YAAMN,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAW,KAAKC,WAAL,CAAiBC,UAAjB,EAAX,CAAd;;AACA,YAAMC,IAAI;AACNC,UAAAA,EAAE,EAAFA;AADM,WAEH,IAFG,CAAV;;AAIA,YAAMO,KAAK,GAAGb,KAAK,CAACc,SAAN,CAAgB,UAAAC,CAAC;AAAA,iBAAIT,EAAE,KAAKS,CAAC,CAACT,EAAb;AAAA,SAAjB,CAAd;;AACA,YAAIO,KAAK,KAAK,CAAC,CAAf,EAAkB;AACdb,UAAAA,KAAK,CAACa,KAAD,CAAL,GAAeR,IAAf;;AACAI,sBAAGC,aAAH,CAAiBtB,CAAjB,EAAoBa,IAAI,CAACU,SAAL,CAAeX,KAAf,CAApB;;AACA,iBAAOA,KAAK,CAACa,KAAD,CAAZ;AACH;;AACD,eAAO,EAAP;AACH,OAbD,CAaE,OAAOD,GAAP,EAAY;AACV,eAAO;AAAEA,UAAAA,GAAG,EAAEA,GAAG,CAACI;AAAX,SAAP;AACH;AACJ;;;iCApCmB;AAChB,aAAOP,YAAGQ,YAAH,CAAgB7B,CAAhB,EAAmB,OAAnB,CAAP;AACH;;;4BAoCakB,E,EAAI;AACd,UAAIN,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAW,KAAKE,UAAL,EAAX,CAAZ;AACAJ,MAAAA,KAAK,GAAGA,KAAK,CAACkB,MAAN,CAAa,UAAAb,IAAI;AAAA,eAAIA,IAAI,CAACC,EAAL,KAAYA,EAAhB;AAAA,OAAjB,CAAR;;AACAG,kBAAGC,aAAH,CAAiBtB,CAAjB,EAAoBa,IAAI,CAACU,SAAL,CAAeX,KAAf,CAApB;AACH;;;;;;eAGUR,I","sourcesContent":["import fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst p = path.join(__dirname, '../data', 'meals.json');\r\n\r\nclass Meal {\r\n    constructor({\r\n        title,\r\n        description,\r\n        image,\r\n        price,\r\n        defaultQuantity,\r\n    }) {\r\n        Object.assign(this, {\r\n            title, description, image, price, defaultQuantity,\r\n        });\r\n    }\r\n\r\n    static fetchMeals() {\r\n        return fs.readFileSync(p, 'utf-8');\r\n    }\r\n\r\n    add() {\r\n        try {\r\n            const meals = JSON.parse(this.constructor.fetchMeals());\r\n            const meal = {\r\n                id: meals.length + 1,\r\n                ...this,\r\n            };\r\n            meals.push(meal);\r\n            fs.writeFileSync(p, JSON.stringify(meals));\r\n            return meal;\r\n        } catch (err) {\r\n            return err;\r\n        }\r\n    }\r\n\r\n    update(id) {\r\n        try {\r\n            const meals = JSON.parse(this.constructor.fetchMeals());\r\n            const meal = {\r\n                id,\r\n                ...this,\r\n            };\r\n            const index = meals.findIndex(m => id === m.id);\r\n            if (index !== -1) {\r\n                meals[index] = meal;\r\n                fs.writeFileSync(p, JSON.stringify(meals));\r\n                return meals[index];\r\n            }\r\n            return {};\r\n        } catch (err) {\r\n            return { err: err.message };\r\n        }\r\n    }\r\n\r\n    static delete(id) {\r\n        let meals = JSON.parse(this.fetchMeals());\r\n        meals = meals.filter(meal => meal.id !== id);\r\n        fs.writeFileSync(p, JSON.stringify(meals));\r\n    }\r\n}\r\n\r\nexport default Meal;\r\n"],"file":"meal.js"}