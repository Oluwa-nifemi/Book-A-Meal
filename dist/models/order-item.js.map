{"version":3,"sources":["../../models/order-item.js"],"names":["p","path","join","__dirname","OrderItem","mealId","userId","quantity","status","Object","assign","orderItems","JSON","parse","fs","readFileSync","find","item","err","id","length","push","writeFileSync","stringify","orderItemsFiltered","filter","index","findIndex","elem"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;;;;;;;AAEA,IAAMA,CAAC,GAAGC,cAAKC,IAAL,CAAUC,SAAV,EAAqB,SAArB,EAAgC,kBAAhC,CAAV;;IAEMC,S;;;AACF,2BAKG;AAAA,QAJCC,MAID,QAJCA,MAID;AAAA,QAHCC,MAGD,QAHCA,MAGD;AAAA,QAFCC,QAED,QAFCA,QAED;AAAA,QADCC,MACD,QADCA,MACD;;AAAA;;AACCC,IAAAA,MAAM,CAACC,MAAP,CAAc,IAAd,EAAoB;AAChBL,MAAAA,MAAM,EAANA,MADgB;AACRC,MAAAA,MAAM,EAANA,MADQ;AACAC,MAAAA,QAAQ,EAARA,QADA;AACUC,MAAAA,MAAM,EAANA;AADV,KAApB;AAGH;;;;0BAQK;AAAA;;AACF,UAAMG,UAAU,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAGC,YAAH,CAAgBf,CAAhB,CAAX,CAAnB;;AACA,UAAIW,UAAU,CAACK,IAAX,CAAgB,UAAAC,IAAI;AAAA,eAAIA,IAAI,CAACZ,MAAL,KAAgB,KAAI,CAACA,MAArB,IAA+BY,IAAI,CAACX,MAAL,KAAgB,KAAI,CAACA,MAAxD;AAAA,OAApB,CAAJ,EAAyF;AACrF,eAAO;AAAEY,UAAAA,GAAG,EAAE;AAAP,SAAP;AACH;;AACD,UAAMC,EAAE,GAAGR,UAAU,CAACS,MAAX,GAAoB,CAA/B;AACAT,MAAAA,UAAU,CAACU,IAAX;AAAkBF,QAAAA,EAAE,EAAFA;AAAlB,SAAyB,IAAzB;;AACAL,kBAAGQ,aAAH,CAAiBtB,CAAjB,EAAoBY,IAAI,CAACW,SAAL,CAAeZ,UAAf,CAApB;;AACA;AAASQ,QAAAA,EAAE,EAAFA;AAAT,SAAgB,IAAhB;AACH;;;kCAfoBA,E,EAAI;AACrB,UAAMR,UAAU,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAGC,YAAH,CAAgBf,CAAhB,CAAX,CAAnB;AACA,UAAMwB,kBAAkB,GAAGb,UAAU,CAACc,MAAX,CAAkB,UAAAR,IAAI;AAAA,eAAIA,IAAI,CAACX,MAAL,KAAgBa,EAAhB,IAAsBF,IAAI,CAACT,MAAL,KAAgB,MAA1C;AAAA,OAAtB,CAA3B;AACA,aAAOgB,kBAAP;AACH;;;yBAaWP,I,EAAM;AACd,UAAMN,UAAU,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAGC,YAAH,CAAgBf,CAAhB,CAAX,CAAnB;AACA,UAAM0B,KAAK,GAAGf,UAAU,CAACgB,SAAX,CAAqB,UAAAC,IAAI;AAAA,eAAIA,IAAI,CAACT,EAAL,KAAYF,IAAI,CAACE,EAArB;AAAA,OAAzB,CAAd;;AACA,UAAIO,KAAK,KAAK,CAAC,CAAf,EAAkB;AACdf,QAAAA,UAAU,CAACe,KAAD,CAAV,GAAoBT,IAApB;;AACAH,oBAAGQ,aAAH,CAAiBtB,CAAjB,EAAoBY,IAAI,CAACW,SAAL,CAAeZ,UAAf,CAApB;;AACA,eAAOM,IAAP;AACH;;AACD,aAAO;AAAEC,QAAAA,GAAG,EAAE;AAAP,OAAP;AACH;;;4BAEaC,E,EAAI;AACd,UAAIR,UAAU,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAGC,YAAH,CAAgBf,CAAhB,CAAX,CAAjB;AACAW,MAAAA,UAAU,GAAGA,UAAU,CAACc,MAAX,CAAkB,UAAAR,IAAI;AAAA,eAAIA,IAAI,CAACE,EAAL,KAAYA,EAAhB;AAAA,OAAtB,CAAb;;AACAL,kBAAGQ,aAAH,CAAiBtB,CAAjB,EAAoBY,IAAI,CAACW,SAAL,CAAeZ,UAAf,CAApB;AACH;;;;;;eAGUP,S","sourcesContent":["import fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst p = path.join(__dirname, '../data', 'order-items.json');\r\n\r\nclass OrderItem {\r\n    constructor({\r\n        mealId,\r\n        userId,\r\n        quantity,\r\n        status,\r\n    }) {\r\n        Object.assign(this, {\r\n            mealId, userId, quantity, status,\r\n        });\r\n    }\r\n\r\n    static getOrderItems(id) {\r\n        const orderItems = JSON.parse(fs.readFileSync(p));\r\n        const orderItemsFiltered = orderItems.filter(item => item.userId === id && item.status === 'cart');\r\n        return orderItemsFiltered;\r\n    }\r\n\r\n    add() {\r\n        const orderItems = JSON.parse(fs.readFileSync(p));\r\n        if (orderItems.find(item => item.mealId === this.mealId && item.userId === this.userId)) {\r\n            return { err: 'Meal already exists you can increase the quantity in your cart' };\r\n        }\r\n        const id = orderItems.length + 1;\r\n        orderItems.push({ id, ...this });\r\n        fs.writeFileSync(p, JSON.stringify(orderItems));\r\n        return { id, ...this };\r\n    }\r\n\r\n    static edit(item) {\r\n        const orderItems = JSON.parse(fs.readFileSync(p));\r\n        const index = orderItems.findIndex(elem => elem.id === item.id);\r\n        if (index !== -1) {\r\n            orderItems[index] = item;\r\n            fs.writeFileSync(p, JSON.stringify(orderItems));\r\n            return item;\r\n        }\r\n        return { err: \"Meal doesn't exist database\" };\r\n    }\r\n\r\n    static delete(id) {\r\n        let orderItems = JSON.parse(fs.readFileSync(p));\r\n        orderItems = orderItems.filter(item => item.id !== id);\r\n        fs.writeFileSync(p, JSON.stringify(orderItems));\r\n    }\r\n}\r\n\r\nexport default OrderItem;\r\n"],"file":"order-item.js"}